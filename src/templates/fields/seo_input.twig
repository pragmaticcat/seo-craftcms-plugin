{% import "_includes/forms" as forms %}

{% set seoFieldUid = field.handle ~ '-seo-tabs' %}

{% css %}
  .seo-tabs-wrap .seo-grid {
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 12px;
  }

  @media (max-width: 900px) {
    .seo-tabs-wrap .seo-grid {
      grid-template-columns: 1fr;
    }
  }

  .seo-tabs-wrap .seo-tab-buttons {
    display: flex;
    gap: 8px;
    margin-bottom: 12px;
  }

  .seo-tabs-wrap .seo-tab-btn {
    cursor: pointer;
  }

  .seo-tabs-wrap .seo-tab-btn:not(.active) {
    opacity: 0.75;
  }
{% endcss %}

<div id="{{ seoFieldUid }}" class="seo-tabs-wrap">
  <div class="seo-tab-buttons">
    <button type="button" class="btn seo-tab-btn active" data-target="{{ seoFieldUid }}-general">General</button>
    <button type="button" class="btn seo-tab-btn" data-target="{{ seoFieldUid }}-options">Opciones</button>
  </div>

  <div id="{{ seoFieldUid }}-general" class="seo-tab-panel">
    <div class="seo-grid">
      {{ forms.textField({
        label: 'Titulo',
        name: field.handle ~ '[title]',
        value: value.title,
      }) }}

      {{ forms.textareaField({
        label: 'Descripcion',
        name: field.handle ~ '[description]',
        value: value.description,
        rows: 3,
      }) }}

      {{ forms.elementSelectField({
        label: 'Imagen',
        id: field.handle ~ '-image',
        name: field.handle ~ '[imageId][]',
        elementType: 'craft\\\\elements\\\\Asset',
        elements: imageElement ? [imageElement] : [],
        limit: 1,
        sources: '*',
        criteria: { kind: 'image' },
      }) }}

      {{ forms.textareaField({
        label: 'Descripcion de imagen',
        name: field.handle ~ '[imageDescription]',
        value: value.imageDescription,
        rows: 3,
      }) }}
    </div>
  </div>

  <div id="{{ seoFieldUid }}-options" class="seo-tab-panel" style="display: none;">
    <div class="seo-grid">
      {{ forms.lightswitchField({
        label: 'Sitemap: visible',
        name: field.handle ~ '[sitemapEnabled]',
        on: value.sitemapEnabled is same as(false) ? false : true,
        value: 1,
      }) }}

      {{ forms.lightswitchField({
        label: 'Sitemap: incluir imagenes',
        name: field.handle ~ '[sitemapIncludeImages]',
        on: value.sitemapIncludeImages is same as(true),
        value: 1,
      }) }}
    </div>
  </div>
</div>

{% js %}
  (function() {
    const container = document.getElementById('{{ seoFieldUid|e('js') }}');
    if (!container) {
      return;
    }

    const buttons = container.querySelectorAll('.seo-tab-btn');
    const panels = container.querySelectorAll('.seo-tab-panel');
    buttons.forEach((btn) => {
      btn.addEventListener('click', () => {
        const targetId = btn.getAttribute('data-target');
        buttons.forEach((b) => b.classList.remove('active'));
        btn.classList.add('active');
        panels.forEach((panel) => {
          panel.style.display = panel.id === targetId ? '' : 'none';
        });
      });
    });
  })();
{% endjs %}
